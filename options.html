<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitSyncMarks ‚Äì Settings</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <header class="page-header">
      <h1>
        <img src="icons/icon48.png" alt="Icon" class="header-icon">
        GitSyncMarks
      </h1>
      <div class="header-actions">
        <select id="language-select">
          <!-- Populated dynamically -->
        </select>
        <button type="button" id="theme-cycle-btn" class="theme-cycle-btn" role="button" aria-label="Theme">A</button>
      </div>
    </header>

    <section id="onboarding-wizard-screen" class="card onboarding-screen" style="display: none;">
      <h2 data-i18n="options_onboardingWizardTitle">Setup wizard</h2>
      <p id="onboarding-wizard-step-title" class="onboarding-wizard-step-title"></p>
      <p id="onboarding-wizard-step-text" class="onboarding-wizard-step-text"></p>
      <div class="onboarding-wizard-progress-row">
        <span id="onboarding-wizard-progress" class="onboarding-wizard-progress"></span>
      </div>

      <div id="onboarding-wizard-token-help" class="onboarding-wizard-section" style="display: none;">
        <p data-i18n="options_onboardingWizardTokenHelpIntro">A Personal Access Token (PAT) lets GitSyncMarks access your GitHub repository to sync bookmarks. You create it in your GitHub account settings.</p>
        <p data-i18n-html="options_onboardingWizardTokenHelpScopes">The token needs the <code>repo</code> scope. This gives read/write access to your repositories (including private ones) and lets the extension create a repo if you choose auto-create. Treat the token like a password and keep it private.</p>
        <ol class="onboarding-wizard-token-steps">
          <li data-i18n="options_onboardingWizardTokenStep1">Click the link below to open GitHub's token creation page.</li>
          <li data-i18n="options_onboardingWizardTokenStep2">Give the token a name (e.g. "GitSyncMarks") and set an expiration if you prefer.</li>
          <li data-i18n-html="options_onboardingWizardTokenStep3">Under "Scopes", check <code>repo</code> (full control of private repositories).</li>
          <li data-i18n="options_onboardingWizardTokenStep4">Click "Generate token", copy it, and paste it in the field below.</li>
        </ol>
        <a href="https://github.com/settings/tokens/new?scopes=repo&description=GitSyncMarks+Sync" target="_blank" rel="noopener" class="onboarding-wizard-token-link" data-i18n="options_onboardingWizardTokenHelpLink">Open GitHub token page</a>
      </div>

      <div id="onboarding-wizard-has-token-group" class="onboarding-wizard-section" style="display: none;">
        <label for="onboarding-wizard-has-token" data-i18n="options_onboardingWizardHasTokenLabel">Do you already have a token?</label>
        <select id="onboarding-wizard-has-token">
          <option value="yes" data-i18n="options_onboardingWizardHasTokenYes">Yes, I already have one</option>
          <option value="no" data-i18n="options_onboardingWizardHasTokenNo">No, show me how</option>
        </select>
      </div>

      <div id="onboarding-wizard-token-group" class="onboarding-wizard-section" style="display: none;">
        <label for="onboarding-wizard-token" data-i18n="options_patLabel">Personal Access Token (PAT)</label>
        <input type="password" id="onboarding-wizard-token" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" autocomplete="off">
      </div>

      <div id="onboarding-wizard-repo-flow-group" class="onboarding-wizard-section" style="display: none;">
        <label for="onboarding-wizard-repo-flow" data-i18n="options_onboardingWizardRepoFlowLabel">Repository setup mode</label>
        <select id="onboarding-wizard-repo-flow">
          <option value="autoCreate" data-i18n="options_onboardingWizardRepoFlowAuto">Auto-create repository</option>
          <option value="manual" data-i18n="options_onboardingWizardRepoFlowManual">Use existing repository</option>
        </select>
      </div>

      <div id="onboarding-wizard-repo-group" class="onboarding-wizard-section" style="display: none;">
        <label for="onboarding-wizard-owner" data-i18n="options_repoOwner">Repository Owner</label>
        <input type="text" id="onboarding-wizard-owner" data-i18n-placeholder="options_ownerPlaceholder" placeholder="your-github-username">
        <label for="onboarding-wizard-repo" data-i18n="options_repoName">Repository Name</label>
        <input type="text" id="onboarding-wizard-repo" placeholder="my-bookmarks">
        <label for="onboarding-wizard-branch" data-i18n="options_branch">Branch</label>
        <input type="text" id="onboarding-wizard-branch" placeholder="main" value="main">
        <label for="onboarding-wizard-path" data-i18n="options_filePath">File Path in Repository</label>
        <input type="text" id="onboarding-wizard-path" placeholder="bookmarks" value="bookmarks">
      </div>

      <div class="onboarding-wizard-actions">
        <button type="button" id="onboarding-wizard-action-btn" class="btn btn-secondary btn-sm" style="display: none;"></button>
        <button type="button" id="onboarding-wizard-back-btn" class="btn btn-secondary btn-sm" data-i18n="options_onboardingWizardBack">Back</button>
        <button type="button" id="onboarding-wizard-next-btn" class="btn btn-primary btn-sm" data-i18n="options_onboardingWizardNext">Next</button>
        <button type="button" id="onboarding-wizard-skip-btn" class="btn btn-secondary btn-sm" data-i18n="options_onboardingWizardSkip">Exit</button>
      </div>
      <div class="onboarding-wizard-feedback">
        <span id="onboarding-wizard-spinner" class="spinner" style="display: none;"></span>
        <span id="onboarding-wizard-hint" class="onboarding-wizard-hint" style="display: none;"></span>
      </div>
      <span id="onboarding-wizard-result" class="validation-result"></span>
    </section>

    <div id="settings-shell">
    <nav class="tab-bar">
      <button class="tab-btn active" data-tab="github" data-i18n="options_tabGitHub">GitHub</button>
      <button class="tab-btn" data-tab="sync" data-i18n="options_tabSynchronization">Sync</button>
      <button class="tab-btn" data-tab="files" data-i18n="options_tabFiles">Files</button>
      <button class="tab-btn" data-tab="help" data-i18n="options_tabHelp">Help</button>
      <button class="tab-btn" data-tab="about" data-i18n="options_tabAbout">About</button>
    </nav>

    <!-- ==================== GitHub Tab ==================== -->
    <div class="tab-content active" id="tab-github">

      <div class="sub-tab-bar">
        <button class="sub-tab-btn active" data-subtab="github-profile" data-i18n="options_subTabProfile">Profile</button>
        <button class="sub-tab-btn" data-subtab="github-connection" data-i18n="options_subTabConnection">Connection</button>
        <button class="sub-tab-btn" data-subtab="github-repos" data-i18n="options_subTabRepos">GitHub Folder</button>
      </div>

      <div class="sub-tab-content active" id="subtab-github-profile">
        <section class="card profile-selector-card">
          <h2 data-i18n="options_profile">Profile</h2>
          <div class="profile-main-row">
            <div class="profile-select-wrap">
              <label for="profile-select" class="form-label-inline" data-i18n="options_profile">Profile</label>
              <select id="profile-select" class="profile-select"></select>
            </div>
            <div class="profile-actions">
              <span id="profile-limit" class="profile-limit"></span>
              <span id="profile-spinner" class="spinner" style="display: none;"></span>
              <span id="profile-switching-msg" class="profile-switching-msg" style="display: none;"></span>
              <button type="button" id="profile-add-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileAdd">+ Add</button>
              <button type="button" id="profile-rename-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileRename" style="display: none;">Rename</button>
              <button type="button" id="profile-delete-btn" class="btn btn-secondary btn-sm btn-danger" data-i18n="options_profileDelete" title="" style="display: none;">Delete</button>
            </div>
          </div>
          <div class="profile-options">
            <label for="profile-switch-without-confirm" class="profile-option-toggle">
              <input type="checkbox" id="profile-switch-without-confirm">
              <span class="toggle-slider toggle-slider-sm"></span>
              <span data-i18n="options_profileSwitchWithoutConfirm">Switch without confirmation</span>
            </label>
          </div>
          <div id="profile-switch-confirm" class="profile-switch-confirm" style="display: none;">
            <span id="profile-switch-confirm-text" class="profile-switch-confirm-text"></span>
            <div class="profile-switch-confirm-actions">
              <button type="button" id="profile-switch-confirm-btn" class="btn btn-primary btn-sm" data-i18n="options_profileSwitchConfirmBtn">Switch</button>
              <button type="button" id="profile-switch-cancel-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
            </div>
          </div>
          <div id="profile-delete-confirm" class="profile-inline-dialog" style="display: none;">
            <span id="profile-delete-confirm-text" class="profile-inline-dialog-text"></span>
            <div class="profile-inline-dialog-actions">
              <button type="button" id="profile-delete-confirm-btn" class="btn btn-danger btn-sm" data-i18n="options_profileDelete">Delete</button>
              <button type="button" id="profile-delete-cancel-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
            </div>
          </div>
          <div id="profile-add-dialog" class="profile-inline-dialog" style="display: none;">
            <div class="profile-inline-dialog-body">
              <label for="profile-add-name-input" class="profile-inline-dialog-label" data-i18n="options_profileAddNameLabel">Profile name</label>
              <input type="text" id="profile-add-name-input" class="profile-inline-dialog-input" data-i18n-placeholder="options_profileAddPlaceholder" placeholder="New Profile">
            </div>
            <div class="profile-inline-dialog-actions">
              <button type="button" id="profile-add-confirm-btn" class="btn btn-primary btn-sm" data-i18n="options_profileAddConfirmBtn">Add</button>
              <button type="button" id="profile-add-cancel-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
            </div>
          </div>
          <div id="profile-rename-dialog" class="profile-inline-dialog" style="display: none;">
            <div class="profile-inline-dialog-body">
              <label for="profile-rename-input" class="profile-inline-dialog-label" data-i18n="options_profileRenameLabel">New name</label>
              <input type="text" id="profile-rename-input" class="profile-inline-dialog-input">
            </div>
            <div class="profile-inline-dialog-actions">
              <button type="button" id="profile-rename-confirm-btn" class="btn btn-primary btn-sm" data-i18n="options_profileRename">Rename</button>
              <button type="button" id="profile-rename-cancel-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
            </div>
          </div>
          <div id="profile-message" class="profile-message" style="display: none;"></div>
        </section>
      </div>

      <div class="sub-tab-content" id="subtab-github-connection">
        <section class="card">
          <h2 data-i18n="options_githubConnection">GitHub Connection</h2>

          <div class="form-group">
            <label for="token" data-i18n="options_patLabel">Personal Access Token (PAT)</label>
            <div class="input-row">
              <input type="password" id="token" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" autocomplete="off">
              <button id="toggle-token" class="btn-icon" data-i18n-title="options_toggleToken" title="Show/hide token">
                <span class="icon-eye">üëÅ</span>
              </button>
            </div>
            <small data-i18n-html="options_tokenHint">Requires the <code>repo</code> scope. <a href="https://github.com/settings/tokens/new?scopes=repo&description=GitSyncMarks" target="_blank" rel="noopener">Create token</a></small>
          </div>

          <div class="form-group">
            <label for="owner" data-i18n="options_repoOwner">Repository Owner</label>
            <input type="text" id="owner" data-i18n-placeholder="options_ownerPlaceholder" placeholder="your-github-username">
          </div>

          <div class="form-group">
            <label for="repo" data-i18n="options_repoName">Repository Name</label>
            <input type="text" id="repo" placeholder="my-bookmarks">
          </div>

          <div class="form-group">
            <label for="branch" data-i18n="options_branch">Branch</label>
            <input type="text" id="branch" placeholder="main" value="main">
          </div>

          <div class="form-group">
            <label for="filepath" data-i18n="options_filePath">File Path in Repository</label>
            <div class="filepath-browse-wrapper">
              <input type="text" id="filepath" placeholder="bookmarks" value="bookmarks">
              <button type="button" id="btn-browse-folder" class="btn-icon" data-i18n-title="options_browseFolder" title="Browse">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 4.5V12a1.5 1.5 0 001.5 1.5h9A1.5 1.5 0 0014 12V6.5A1.5 1.5 0 0012.5 5H8L6.5 3H3.5A1.5 1.5 0 002 4.5z"/></svg>
              </button>
            </div>
            <div id="folder-browser" class="folder-browser hidden">
              <div class="folder-browser-header">
                <button type="button" id="btn-folder-up" class="btn-icon btn-icon-sm" disabled title="Up">&#8593;</button>
                <span id="folder-browser-path" class="folder-browser-path">/</span>
              </div>
              <ul id="folder-browser-list" class="folder-browser-list"></ul>
              <div id="folder-browser-empty" class="folder-browser-msg hidden" data-i18n="options_browseFolderEmpty">No folders found</div>
              <div id="folder-browser-loading" class="folder-browser-msg" data-i18n="options_browseFolderLoading">Loading‚Ä¶</div>
            </div>
            <small data-i18n="options_filePathHint">Folder where bookmark files will be stored.</small>
          </div>

          <div class="form-group">
            <button id="validate-btn" class="btn btn-secondary" data-i18n="options_testConnection">Test Connection</button>
            <span id="validation-spinner" class="spinner" style="display: none;"></span>
            <span id="validation-result" class="validation-result"></span>
            <div id="connection-path-init-group" style="display: none; margin-top: 0.75rem;">
              <button type="button" id="connection-path-init-btn" class="btn btn-secondary btn-sm" data-i18n="options_onboardingInitPathBtn">Create path and run first sync</button>
              <small id="connection-path-init-hint" style="display: block; margin-top: 0.35rem;"></small>
            </div>
            <div id="onboarding-confirm" class="onboarding-confirm" style="display: none; margin-top: 0.75rem;">
              <span id="onboarding-confirm-text" class="onboarding-confirm-text"></span>
              <div class="onboarding-confirm-actions">
                <button type="button" id="onboarding-confirm-yes-btn" class="btn btn-primary btn-sm"></button>
                <button type="button" id="onboarding-confirm-no-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
              </div>
            </div>
          </div>

          <div class="actions actions-in-card actions-github-feedback">
            <button type="button" id="onboarding-wizard-start-btn" class="btn btn-secondary btn-sm" data-i18n="options_onboardingWizardStart">Start setup wizard</button>
            <span id="save-github-result" class="save-result"></span>
          </div>
        </section>
      </div>

      <div class="sub-tab-content" id="subtab-github-repos">
        <section class="card" id="github-repos-card" style="display: none;">
          <h2 data-i18n="options_githubReposTitle">GitHub Repos Folder</h2>
          <p class="card-desc" data-i18n="options_githubReposDesc">Create a folder with bookmarks to all your GitHub repositories (public and private).</p>

          <div class="form-group toggle-group">
            <label for="github-repos-enabled" class="toggle-label">
              <span data-i18n="options_githubReposEnabled">GitHub Repos folder</span>
              <input type="checkbox" id="github-repos-enabled">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div id="github-repos-options" style="display: none;">
            <div class="form-group">
              <label for="github-repos-parent" data-i18n="options_githubReposParentLabel">Position</label>
              <select id="github-repos-parent">
                <option value="toolbar" data-i18n="options_githubReposParentToolbar">Bookmarks Bar</option>
                <option value="other" data-i18n="options_githubReposParentOther">Other Bookmarks</option>
              </select>
            </div>

            <div class="form-group">
              <button id="github-repos-refresh-btn" class="btn btn-secondary" data-i18n="options_githubReposRefresh">Update GitHub Repos</button>
              <span id="github-repos-spinner" class="spinner" style="display: none;"></span>
              <span id="github-repos-result" class="validation-result"></span>
            </div>
          </div>
        </section>
      </div>

    </div>
    </div>

    <!-- ==================== Sync Tab ==================== -->
    <div class="tab-content" id="tab-sync">

      <section class="card">
        <h2 data-i18n="options_synchronization">Synchronization</h2>

        <div class="form-group toggle-group">
          <label for="auto-sync" class="toggle-label">
            <span data-i18n="options_autoSync">Automatic Synchronization</span>
            <input type="checkbox" id="auto-sync" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="form-group">
          <label for="sync-profile" data-i18n="options_syncProfile">Sync profile</label>
          <select id="sync-profile">
            <option value="realtime" data-i18n="options_syncProfileRealtime">Real-time</option>
            <option value="frequent" data-i18n="options_syncProfileFrequent">Frequent</option>
            <option value="normal" data-i18n="options_syncProfileNormal">Normal</option>
            <option value="powersave" data-i18n="options_syncProfilePowersave">Power save</option>
            <option value="custom" data-i18n="options_syncProfileCustom">Custom</option>
          </select>
        </div>

        <div id="sync-custom-fields" style="display: none;">
          <div class="form-group">
            <label for="sync-interval" data-i18n="options_syncInterval">Sync Interval (minutes)</label>
            <input type="number" id="sync-interval" min="1" max="120" value="15">
            <small data-i18n="options_syncIntervalHint">How often to check for remote changes.</small>
          </div>
          <div class="form-group">
            <label for="debounce-delay" data-i18n="options_debounceDelay">Debounce delay (seconds)</label>
            <input type="number" id="debounce-delay" min="1" max="60" value="5">
            <small data-i18n="options_debounceDelayHint">Wait time before syncing after bookmark changes.</small>
          </div>
        </div>

        <div class="form-group toggle-group">
          <label for="sync-on-startup" class="toggle-label">
            <span data-i18n="options_syncOnStartup">Sync on browser start</span>
            <input type="checkbox" id="sync-on-startup">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="form-group toggle-group">
          <label for="sync-on-focus" class="toggle-label">
            <span data-i18n="options_syncOnFocus">Sync when browser gains focus</span>
            <input type="checkbox" id="sync-on-focus">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="form-group">
          <label for="notifications-mode" data-i18n="options_notifications">Sync notifications</label>
          <select id="notifications-mode">
            <option value="off" data-i18n="options_notificationsOff">Off</option>
            <option value="all" data-i18n="options_notificationsAll">All (success and failure)</option>
            <option value="errorsOnly" data-i18n="options_notificationsErrorsOnly">Errors only</option>
          </select>
          <small data-i18n="options_notificationsHint">Choose when to show notifications.</small>
        </div>

        <div class="actions actions-in-card actions-sync-feedback">
          <span id="save-sync-result" class="save-result"></span>
        </div>
      </section>

      <details class="help-details card" open>
        <summary>
          <h2 data-i18n="options_debugLogTitle">Debug Log</h2>
        </summary>
        <div class="help-details-body">
          <p data-i18n="options_debugLogDesc">Enable to record sync diagnostics (diffs, merge decisions, conflicts). Use when troubleshooting sync issues. Export and share the log for support.</p>
          <div class="form-group toggle-group" style="margin-top: 0.5rem;">
            <label for="debug-log-enabled" class="toggle-label">
              <span data-i18n="options_debugLogEnabled">Enable debug log</span>
              <input type="checkbox" id="debug-log-enabled">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="debug-log-actions" style="margin-top: 0.5rem; display: flex; gap: 0.5rem; align-items: center;">
            <button type="button" id="debug-log-export-btn" class="btn btn-secondary btn-sm" data-i18n="options_debugLogExport">Export log</button>
            <span id="debug-log-result" class="validation-result" style="margin-left: 0;"></span>
          </div>
        </div>
      </details>

    </div>

    <!-- ==================== Files Tab ==================== -->
    <div class="tab-content" id="tab-files">

      <div class="sub-tab-bar">
        <button class="sub-tab-btn active" data-subtab="files-generated" data-i18n="options_subTabGenerated">Generated</button>
        <button class="sub-tab-btn" data-subtab="files-settings" data-i18n="options_subTabSettings">Settings</button>
        <button class="sub-tab-btn" data-subtab="files-export-import" data-i18n="options_subTabExportImport">Export / Import</button>
        <button class="sub-tab-btn" data-subtab="files-git-add" data-i18n="options_subTabGitAdd">Git Add</button>
      </div>

      <div class="sub-tab-content active" id="subtab-files-generated">
        <section class="card">
          <h2 data-i18n="options_generatedFilesTitle">Generated files</h2>
          <p class="card-desc" data-i18n="options_generatedFilesDesc">Files created in the repo during sync. Choose Off, Manual, or Auto per file.</p>

          <div class="form-group">
            <label for="generate-readme-md" data-i18n="options_generateReadmeMd">README.md</label>
            <select id="generate-readme-md">
              <option value="off" data-i18n="options_generateModeOff">Off</option>
              <option value="manual" data-i18n="options_generateModeManual">Manual</option>
              <option value="auto" selected data-i18n="options_generateModeAuto">Auto</option>
            </select>
            <small data-i18n="options_generateReadmeMdDesc" style="display:block;margin-top:0.25rem;">Markdown overview in the repo.</small>
          </div>
          <div class="form-group">
            <label for="generate-bookmarks-html" data-i18n="options_generateBookmarksHtml">bookmarks.html</label>
            <select id="generate-bookmarks-html">
              <option value="off" data-i18n="options_generateModeOff">Off</option>
              <option value="manual" data-i18n="options_generateModeManual">Manual</option>
              <option value="auto" selected data-i18n="options_generateModeAuto">Auto</option>
            </select>
            <small data-i18n="options_generateBookmarksHtmlDesc" style="display:block;margin-top:0.25rem;">Netscape format for browser import (Chrome, Firefox).</small>
          </div>
          <div class="form-group">
            <label for="generate-feed-xml" data-i18n="options_generateFeedXml">feed.xml</label>
            <select id="generate-feed-xml">
              <option value="off" data-i18n="options_generateModeOff">Off</option>
              <option value="manual" data-i18n="options_generateModeManual">Manual</option>
              <option value="auto" selected data-i18n="options_generateModeAuto">Auto</option>
            </select>
            <small data-i18n="options_generateFeedXmlDesc" style="display:block;margin-top:0.25rem;">RSS 2.0 feed ‚Äî subscribe in any RSS reader or use for automations.</small>
          </div>
          <div class="form-group">
            <label for="generate-dashy-yml" data-i18n="options_generateDashyYml">dashy-conf.yml</label>
            <select id="generate-dashy-yml">
              <option value="off" selected data-i18n="options_generateModeOff">Off</option>
              <option value="manual" data-i18n="options_generateModeManual">Manual</option>
              <option value="auto" data-i18n="options_generateModeAuto">Auto</option>
            </select>
            <small data-i18n="options_generateDashyYmlDesc" style="display:block;margin-top:0.25rem;">Dashy dashboard config ‚Äî import as sections into your conf.yml.</small>
          </div>
          <button id="generate-files-btn" class="btn btn-secondary" data-i18n="options_generateNowBtn" style="margin-top:0.5rem;">Generate now</button>
        </section>
      </div>

      <div class="sub-tab-content" id="subtab-files-settings">
        <section class="card" id="settings-sync-card">
          <h2 data-i18n="options_settingsSyncTitle">Settings File</h2>
          <p class="card-desc" data-i18n="options_settingsSyncDesc">Encrypted backup of extension settings in the repo. Same password on every device.</p>

          <div class="form-group toggle-group">
            <label for="sync-settings-to-git" class="toggle-label">
              <span data-i18n="options_syncSettingsToGit">Sync settings to Git (encrypted)</span>
              <input type="checkbox" id="sync-settings-to-git">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div id="settings-sync-options-group" style="display: none;">
            <div class="form-group">
              <label for="settings-sync-mode" data-i18n="options_settingsSyncModeLabel">Sync mode</label>
              <select id="settings-sync-mode">
                <option value="global" data-i18n="options_settingsSyncModeGlobal" disabled>Global ‚Äî shared across all devices</option>
                <option value="individual" data-i18n="options_settingsSyncModeIndividual" selected>Individual ‚Äî this device only</option>
              </select>
              <small data-i18n="options_settingsSyncModeGlobalTemporarilyDisabled">Global mode is temporarily unavailable. Use profile-based client settings.</small>
            </div>

            <div id="settings-sync-global-write-group" class="form-group toggle-group" style="display: none;">
              <label for="settings-sync-global-write-enabled" class="toggle-label">
                <span data-i18n="options_settingsSyncGlobalWriteEnabled">Allow writing to global settings (settings.enc)</span>
                <input type="checkbox" id="settings-sync-global-write-enabled">
                <span class="toggle-slider"></span>
              </label>
              <small data-i18n="options_settingsSyncGlobalWriteHint">Recommended OFF. If enabled, this client can overwrite global settings for all devices.</small>
            </div>

            <div class="form-group">
              <label for="settings-sync-password" data-i18n="options_settingsSyncPasswordLabel">Encryption password</label>
              <input type="password" id="settings-sync-password" autocomplete="off">
              <small data-i18n="options_settingsSyncPasswordHint">Set once per device. Must be the same on all devices.</small>
            </div>
            <button id="settings-sync-save-pw-btn" class="btn btn-secondary" data-i18n="options_settingsSyncSaveBtn">Save password</button>
            <span id="settings-sync-result" class="validation-result"></span>

            <div id="settings-sync-import-group" style="display: none; margin-top: 1rem;">
              <div class="form-group">
                <label for="settings-sync-client-name" data-i18n="options_settingsSyncClientNameLabel">Client name</label>
                <input type="text" id="settings-sync-client-name" data-i18n-placeholder="options_settingsSyncClientNamePlaceholder" placeholder="my-laptop">
                <small data-i18n="options_settingsSyncClientNameHint">Required. This name identifies your client settings profile in the repository.</small>
              </div>
              <label data-i18n="options_settingsRegistryTitle">Available settings in repository</label>
              <div style="display: flex; gap: 0.5rem; align-items: center; margin-top: 0.4rem;">
                <button id="settings-sync-load-btn" class="btn btn-secondary" data-i18n="options_settingsRegistryRefreshBtn">Refresh</button>
                <select id="settings-sync-device-list" style="flex: 1;" disabled></select>
              </div>
              <div style="display: flex; gap: 0.5rem; align-items: center; margin-top: 0.6rem;">
                <button id="settings-sync-import-btn" class="btn btn-secondary" data-i18n="options_settingsRegistryImportApplyBtn" disabled>Import &amp; Apply</button>
                <button id="settings-sync-push-selected-btn" class="btn btn-secondary" data-i18n="options_settingsRegistrySyncSelectedBtn" disabled>Sync current to selected</button>
              </div>
              <div style="display: flex; gap: 0.5rem; align-items: center; margin-top: 0.6rem;">
                <button id="settings-sync-create-btn" class="btn btn-secondary" data-i18n="options_settingsSyncCreateOwnBtn">Create my client setting</button>
              </div>
              <span id="settings-sync-import-result" class="validation-result"></span>
            </div>
          </div>
        </section>

        <section class="card danger-zone" id="reset-card">
          <h2 data-i18n="options_resetTitle">Reset Extension</h2>
          <p class="card-desc" data-i18n="options_resetDescription">Delete all profiles, tokens, and settings. Your browser bookmarks will not be affected.</p>
          <button type="button" class="btn btn-danger" id="btn-reset-extension" data-i18n="options_resetBtn">Reset all data</button>
          <div id="reset-confirm-dialog" class="reset-confirm-dialog" style="display: none;">
            <p data-i18n="options_resetConfirm">Are you sure? This cannot be undone. All profiles and settings will be permanently deleted.</p>
            <div class="reset-confirm-actions">
              <button type="button" class="btn btn-danger" id="btn-reset-confirm" data-i18n="options_resetConfirmBtn">Yes, delete all data</button>
              <button type="button" class="btn btn-secondary" id="btn-reset-cancel" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
            </div>
          </div>
        </section>
      </div>

      <div class="sub-tab-content" id="subtab-files-export-import">
        <section class="card export-import-card">
          <h2 data-i18n="options_exportImportTitle">Export / Import</h2>
          <p class="card-desc" data-i18n="options_exportImportDesc">Export or import bookmarks and extension settings.</p>

          <div class="export-import-block">
            <h3 class="automation-block-title" data-i18n="options_exportLabel">Export</h3>
            <div class="export-import-row">
              <select id="export-type-select">
                <option value="bookmarks" data-i18n="options_exportTypeBookmarks">Bookmarks (JSON)</option>
                <option value="dashy" data-i18n="options_exportTypeDashy">Dashy Config (YAML)</option>
                <option value="settings-plain" data-i18n="options_exportTypeSettingsPlain">Settings (plain JSON)</option>
                <option value="settings-encrypted" data-i18n="options_exportTypeSettingsEncrypted">Settings (encrypted)</option>
              </select>
              <button id="export-btn" class="btn btn-secondary" data-i18n="options_exportBtn">Export</button>
            </div>
            <span id="export-result" class="ie-result"></span>
          </div>

          <div class="export-import-block">
            <h3 class="automation-block-title" data-i18n="options_importLabel">Import</h3>
            <p id="import-warning" class="backup-warning" data-i18n="options_importBookmarksWarning">Replaces all current bookmarks. Cannot be undone.</p>
            <div class="export-import-row">
              <select id="import-type-select">
                <option value="bookmarks" data-i18n="options_importTypeBookmarks">Bookmarks (JSON)</option>
                <option value="settings" data-i18n="options_importTypeSettings">Settings (JSON / ENC)</option>
              </select>
            </div>
            <div class="backup-file-picker">
              <input type="file" id="import-file" accept=".json" class="backup-file-input">
              <button type="button" class="btn btn-secondary backup-file-trigger" id="import-file-trigger" data-i18n="options_chooseFile">Choose file</button>
              <span class="backup-file-name" id="import-filename"></span>
            </div>
            <div class="backup-actions">
              <button id="import-btn" class="btn btn-primary" data-i18n="options_importBtn" disabled>Import</button>
              <span id="import-result" class="ie-result"></span>
            </div>
          </div>
        </section>
      </div>

      <div class="sub-tab-content" id="subtab-files-git-add">
        <section class="card automation-card">
          <h2 data-i18n="options_automationTitle">Add Bookmarks via Git</h2>
          <p class="card-desc" data-i18n="options_automationIntro">Add bookmarks directly in your repository. The extension picks them up on the next sync and normalizes filenames automatically.</p>

          <div class="automation-block">
            <h3 class="automation-block-title" data-i18n="options_automationCreateFileTitle">Create file in repo</h3>
            <p class="automation-block-desc" data-i18n-html="options_automationCreateFileDesc"></p>
            <div class="automation-copy-wrap">
              <pre id="automation-json-block" class="code-block code-block-sm">{ "title": "Example", "url": "https://example.com" }</pre>
              <button type="button" class="btn btn-secondary btn-sm automation-copy-btn" id="automation-copy-json-btn" data-i18n="options_automationCopy">Copy</button>
            </div>
            <p class="automation-folders">
              <span data-i18n="options_automationFoldersLabel">Folders:</span>
              <code>toolbar</code> <code>other</code>
            </p>
          </div>

          <div class="automation-block">
            <h3 class="automation-block-title" data-i18n="options_automationGithubActionTitle">GitHub Action</h3>
            <p class="automation-workflow-link">
              <a href="https://github.com/d0dg3r/GitSyncMarks/blob/main/.github/workflows/add-bookmark.yml" target="_blank" rel="noopener" data-i18n="options_automationWorkflowLink">
                Copy add-bookmark.yml to your repo
              </a>
              ¬∑
              <a href="https://raw.githubusercontent.com/d0dg3r/GitSyncMarks/main/.github/workflows/add-bookmark.yml" target="_blank" rel="noopener" data-i18n="options_automationWorkflowRaw">Raw</a>
            </p>
            <div class="automation-copy-wrap">
              <pre id="automation-gh-block" class="code-block code-block-sm">gh workflow run add-bookmark.yml \
  -f url="https://example.com" \
  -f title="Example" \
  -f folder="toolbar" \
  -f path="dev-tools" \
  -f base-path="bookmarks"</pre>
              <button type="button" class="btn btn-secondary btn-sm automation-copy-btn" id="automation-copy-gh-btn" data-i18n="options_automationCopy">Copy</button>
            </div>
            <p class="automation-subfolder-example" data-i18n="options_automationSubfolderExample">Example: <code>path="dev-tools"</code> ‚Üí <code>bookmarks/toolbar/dev-tools/</code></p>
            <table class="help-table automation-params-table">
              <tbody>
                <tr><td><code>url</code></td><td data-i18n="options_automationParamUrl">Bookmark URL (required)</td></tr>
                <tr><td><code>title</code></td><td data-i18n="options_automationParamTitle">Title (optional; URL used if empty)</td></tr>
                <tr><td><code>folder</code></td><td data-i18n="options_automationParamSection">Section: toolbar or other</td></tr>
                <tr><td><code>path</code></td><td data-i18n="options_automationParamFolder">Folder within section (e.g. dev-tools)</td></tr>
                <tr><td><code>base-path</code></td><td data-i18n="options_automationParamBasePath">Base folder in repo (default bookmarks; must match File Path setting)</td></tr>
              </tbody>
            </table>
          </div>
        </section>
      </div>

      <div id="password-dialog" class="profile-inline-dialog" style="display: none;">
        <div class="profile-inline-dialog-body">
          <p id="password-dialog-prompt" class="profile-inline-dialog-text"></p>
          <label for="password-dialog-input" class="profile-inline-dialog-label" data-i18n="options_passwordPlaceholder">Password</label>
          <input type="password" id="password-dialog-input" class="profile-inline-dialog-input" autocomplete="off">
        </div>
        <div class="profile-inline-dialog-actions">
          <button type="button" id="password-dialog-confirm-btn" class="btn btn-primary btn-sm" data-i18n="options_exportBtn">Export</button>
          <button type="button" id="password-dialog-cancel-btn" class="btn btn-secondary btn-sm" data-i18n="options_profileSwitchCancelBtn">Cancel</button>
        </div>
      </div>

    </div>

    <!-- ==================== Help Tab ==================== -->
    <div class="tab-content" id="tab-help">

      <div class="sub-tab-bar help-quick-links">
        <a href="https://github.com/d0dg3r/GitSyncMarks/discussions/37" target="_blank" rel="noopener" class="sub-tab-btn help-link-btn" data-i18n="help_voteBacklogBtn">Vote on backlog</a>
        <a href="https://github.com/d0dg3r/GitSyncMarks/tree/main/docs" target="_blank" rel="noopener" class="sub-tab-btn help-link-btn" data-i18n="options_documentation">Documentation</a>
        <a href="https://github.com/d0dg3r/GitSyncMarks/discussions" target="_blank" rel="noopener" class="sub-tab-btn help-link-btn" data-i18n="help_discussions">Discussions</a>
        <a href="https://github.com/d0dg3r/GitSyncMarks/issues" target="_blank" rel="noopener" class="sub-tab-btn help-link-btn" data-i18n="help_reportIssue">Report Issue</a>
      </div>

      <details class="help-details card" open>
        <summary>
          <h2 data-i18n="help_gettingStartedTitle">Getting Started</h2>
        </summary>
        <div class="help-details-body">
          <p data-i18n-html="help_gettingStartedIntro">Create a GitHub repository for your bookmarks, then create a Personal Access Token (PAT) with the <code>repo</code> scope. In the GitHub tab, enter token, repository owner, name, branch (usually <code>main</code>), and the folder path (default: <code>bookmarks</code>). Click <strong>Test Connection</strong> to verify.</p>
          <p data-i18n="help_onboarding">If the folder is empty, you can create the base structure (toolbar, other). If bookmarks already exist in the repo, you can pull them into this browser.</p>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_whySlowTitle">Why does sync sometimes take long?</h2>
        </summary>
        <div class="help-details-body">
          <p data-i18n="help_whySlowIntro">GitSyncMarks uses GitHub's Git Data API for atomic commits. Each changed or new bookmark file requires an API call. With many changes, this adds up.</p>
          <p data-i18n="help_whyAtomic">All changes are written in a single atomic commit: either everything succeeds or nothing does. This prevents partial or corrupted state if the sync is interrupted. One commit instead of many also avoids hitting API rate limits and keeps the Git history clean.</p>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_profilesTitle">Profiles</h2>
        </summary>
        <div class="help-details-body">
        <p data-i18n="help_profilesIntro">Each profile has its own bookmark set and GitHub repo config. Use profiles for work/personal or different devices.</p>
        <dl class="help-dl">
          <dt data-i18n="help_profilesAdd">Add, Rename, Delete</dt>
          <dd data-i18n="help_profilesAddDesc">Select a profile in the dropdown, then Add (new profile), Rename, or Delete. Up to 10 profiles. Deleting removes the selected profile.</dd>
          <dt data-i18n="help_profilesSwitch">Profile switch</dt>
          <dd data-i18n="help_profilesSwitchDesc">Select another profile to switch. Your current bookmarks are saved and pushed to the current profile's repo before switching. The target profile's bookmarks replace the local ones. Use "Switch without confirmation" to skip the confirm dialog.</dd>
        </dl>
        <p class="help-note" data-i18n="help_profilesNote">Profiles work reliably. With multiple profiles, sync conflicts can occasionally occur ‚Äî trying Push or Pull 2‚Äì3 times usually resolves them. This feature is still evolving. If you encounter reproducible bugs, please open an issue on GitHub.</p>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_githubReposTitle">GitHub Repos Folder</h2>
        </summary>
        <div class="help-details-body">
        <p data-i18n-html="help_githubReposDesc">Optional: Create a folder with bookmarks to all your GitHub repositories (public and private). Choose the position (toolbar, other). The folder is synced like normal bookmarks; use <strong>Update GitHub Repos</strong> to refresh the list.</p>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_popupTitle">Popup (extension icon)</h2>
        </summary>
        <div class="help-details-body">
        <dl class="help-dl">
          <dt data-i18n="help_popupProfile">Profile selector</dt>
          <dd data-i18n="help_popupProfileDesc">Switch profiles directly from the popup header.</dd>
          <dt data-i18n="help_popupSyncNow">Sync Now</dt>
          <dd data-i18n="help_popupSyncNowDesc">Full three-way merge sync: local and remote changes are merged automatically when possible.</dd>
          <dt data-i18n="help_popupPush">Push ‚Üë</dt>
          <dd data-i18n="help_popupPushDesc">Upload local bookmarks to GitHub (overwrites remote changes).</dd>
          <dt data-i18n="help_popupPull">Pull ‚Üì</dt>
          <dd data-i18n="help_popupPullDesc">Download from GitHub (overwrites local changes).</dd>
        </dl>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_syncTitle">Sync</h2>
        </summary>
        <div class="help-details-body">
        <dl class="help-dl">
          <dt data-i18n="help_autoSyncTitle">Auto-sync</dt>
          <dd data-i18n="help_autoSyncDesc">When enabled, syncs automatically when you add, edit, or remove bookmarks. A debounce delay waits for rapid changes to finish before syncing.</dd>
          <dt data-i18n="help_syncProfiles">Sync profiles</dt>
          <dd data-i18n="help_syncProfilesDesc">Real-time (1 min), Frequent (5 min), Normal (15 min), or Power save (60 min). Custom lets you set interval and debounce manually.</dd>
          <dt data-i18n="help_syncStartup">Sync on startup / focus</dt>
          <dd data-i18n="help_syncStartupDesc">Optional: sync when the browser starts or when you return to the browser window (with cooldown).</dd>
          <dt data-i18n="help_debugLogTitle">Debug Log</dt>
          <dd data-i18n="help_debugLogDesc">Enable in the Sync tab to record detailed sync diagnostics ‚Äî diffs, merge decisions, and commit hashes. Export the log to share for troubleshooting.</dd>
        </dl>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_filesTitle">Files</h2>
        </summary>
        <div class="help-details-body">
        <dl class="help-dl">
          <dt data-i18n="help_generatedFilesTitle">Generated files</dt>
          <dd data-i18n="help_generatedFilesDesc">README.md, bookmarks.html, feed.xml, and dashy-conf.yml can be created during sync. Choose Off, Manual, or Auto per file in the Files tab.</dd>
          <dt data-i18n="help_settingsSyncTitle">Settings sync to Git</dt>
          <dd data-i18n="help_settingsSyncDesc">When enabled, extension settings are encrypted and stored in the repo as profile folders (profiles/&lt;alias&gt;/settings.enc). Import and sync explicit client profiles from the repository list.</dd>
          <dt data-i18n="help_backupBookmarks">Export / Import</dt>
          <dd data-i18n="help_backupBookmarksDesc2">Export bookmarks (JSON), Dashy config (YAML), or settings (plain JSON / encrypted .enc). Import bookmarks or settings ‚Äî encrypted files are decrypted with your password. Bookmark import replaces all local bookmarks; settings import replaces all profiles and reloads the page.</dd>
        </dl>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_notificationsTitle">Notifications</h2>
        </summary>
        <div class="help-details-body">
        <p data-i18n="help_notificationsDesc">Choose when to show sync notifications: All (success and failure), Errors only, or Off.</p>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_conflictTitle">Conflicts</h2>
        </summary>
        <div class="help-details-body">
        <p data-i18n-html="help_conflictDesc">When both local and remote bookmarks changed, the popup shows a conflict. Choose <strong>Push</strong> (local wins, overwrite remote) or <strong>Pull</strong> (remote wins, overwrite local). There is no automatic merge for conflicts.</p>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_shortcuts">Keyboard Shortcuts</h2>
        </summary>
        <div class="help-details-body">
        <table class="help-table">
          <tr><td><kbd id="shortcut-quick-sync">Ctrl+Shift+.</kbd></td><td data-i18n="help_quickSync">Quick sync bookmarks</td></tr>
          <tr><td><kbd id="shortcut-open-options">Ctrl+Shift+,</kbd></td><td data-i18n="help_openOptions">Open extension settings</td></tr>
        </table>
        <button type="button" class="sub-tab-btn" id="btn-customize-shortcuts" data-i18n="help_customizeShortcuts">Customize shortcuts</button>
        </div>
      </details>

      <details class="help-details card">
        <summary>
          <h2 data-i18n="help_themeAutoSaveTitle">Theme & Auto-save</h2>
        </summary>
        <div class="help-details-body">
        <dl class="help-dl">
          <dt data-i18n="help_themeCycleTitle">Theme</dt>
          <dd data-i18n="help_themeCycleDesc">Click the button in the header to cycle: Auto (system) ‚Üí Dark ‚Üí Light ‚Üí Auto. The icon shows the current mode. Works in options and popup.</dd>
          <dt data-i18n="help_autoSaveTitle">Auto-save</dt>
          <dd data-i18n="help_autoSaveDesc">All settings save automatically when you change them ‚Äî there are no Save buttons. Changes take effect immediately.</dd>
        </dl>
        </div>
      </details>

    </div>

    <!-- ==================== About Tab ==================== -->
    <div class="tab-content" id="tab-about">

      <section class="card about-card">
        <div class="about-header">
          <img src="icons/icon48.png" alt="" class="about-logo">
          <div class="about-brand">
            <h2>GitSyncMarks</h2>
            <p class="about-version"><span data-i18n="options_version">Version</span> <span id="app-version"></span></p>
          </div>
        </div>
        <div class="about-meta">
          <p class="about-author"><span data-i18n="options_by">By</span> <a href="https://github.com/d0dg3r" target="_blank" rel="noopener">Joe Mild (d0dg3r)</a></p>
          <div class="about-contributors-block">
            <h3 data-i18n="options_specialThanks">Special Thanks</h3>
            <ul class="about-contributors">
              <li><a href="https://github.com/G3Rn0t" target="_blank" rel="noopener" class="contributor-name">Gernot B. (G3Rn0t)</a></li>
              <li><a href="https://github.com/Mr-Whitening" target="_blank" rel="noopener" class="contributor-name">Patrick W. (Mr-Whitening)</a></li>
              
            </ul>
          </div>
        </div>
        <div class="about-mobile-block">
          <h3 data-i18n="options_mobileAppTitle">Mobile App</h3>
          <p class="about-mobile-desc" data-i18n="options_mobileAppDesc">View your bookmarks on the go. GitSyncMarks-App (iOS + Android) syncs from your GitHub repo ‚Äî read-only companion.</p>
          <ul class="about-mobile-links">
            <li><a href="https://github.com/d0dg3r/GitSyncMarks-App" target="_blank" rel="noopener" data-i18n="options_mobileAppLink">GitSyncMarks-App on GitHub</a></li>
          </ul>
          <p class="about-mobile-note" data-i18n="options_mobileAppStores">F-Droid and Google Play coming soon.</p>
        </div>
        <div class="about-links-block">
          <h3 data-i18n="options_links">Links</h3>
          <ul class="about-links">
            <li><a href="https://github.com/d0dg3r/GitSyncMarks" target="_blank" rel="noopener" data-i18n="options_githubRepo">GitHub Repository</a></li>
            <li><a href="https://github.com/d0dg3r/GitSyncMarks/blob/main/PRIVACY.md" target="_blank" rel="noopener" data-i18n="options_privacyPolicy">Privacy Policy</a></li>
            <li><a href="https://github.com/d0dg3r/GitSyncMarks/blob/main/LICENSE" target="_blank" rel="noopener" data-i18n="options_license">License (MIT)</a></li>
          </ul>
        </div>
      </section>

    </div>

  </div>

  <script src="options.js" type="module"></script>
</body>
</html>
