<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitSyncMarks</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup">
    <header class="popup-header">
      <div class="popup-header-left">
        <img src="icons/icon48.png" alt="Icon" class="popup-icon">
        <h1>GitSyncMarks</h1>
      </div>
      <select id="profile-select" class="profile-select header-profile" style="display: none;"></select>
    </header>

    <!-- Not configured state -->
    <div id="not-configured" class="state" style="display: none;">
      <div class="status-box status-warning">
        <span class="status-icon">⚙️</span>
        <span data-i18n="popup_configureFirst">Please configure the extension first.</span>
      </div>
      <button id="open-settings-btn" class="btn btn-primary btn-full" data-i18n="popup_openSettings">Open Settings</button>
    </div>

    <!-- Configured / main state -->
    <div id="configured" class="state" style="display: none;">
      <!-- Status area (replaces status-box for cleaner hierarchy) -->
      <div id="status-area" class="status-area">
        <div class="status-line">
          <span id="status-message" data-i18n="popup_ready">Ready</span>
        </div>
        <div class="status-meta">
          <span id="last-data-change" class="status-meta-item" style="display: none;"></span>
          <span id="last-commit-wrap" class="status-meta-item last-commit-wrap" style="display: none;"></span>
        </div>
      </div>

      <!-- Conflict warning -->
      <div id="conflict-box" class="conflict-box" style="display: none;">
        <div class="conflict-header">
          <span>⚠️</span>
          <strong data-i18n="popup_conflictDetected">Conflict detected</strong>
        </div>
        <p data-i18n="popup_conflictDescription">Both local and remote bookmarks were modified. Choose a resolution:</p>
        <div class="conflict-actions">
          <button id="force-push-btn" class="btn btn-small btn-warning" data-i18n="popup_localToGithub">Local → GitHub</button>
          <button id="force-pull-btn" class="btn btn-small btn-secondary" data-i18n="popup_githubToLocal">GitHub → Local</button>
        </div>
      </div>

      <!-- Action buttons -->
      <div class="actions">
        <button id="sync-btn" class="btn btn-primary btn-full">
          <span class="btn-content">
            <span id="sync-spinner" class="spinner" style="display: none;"></span>
            <span id="sync-text" data-i18n="popup_syncNow">Sync Now</span>
          </span>
        </button>
        <div class="action-row">
          <button id="push-btn" class="btn btn-secondary btn-half" data-i18n="popup_pushUp">Push ↑</button>
          <button id="pull-btn" class="btn btn-secondary btn-half" data-i18n="popup_pullDown">Pull ↓</button>
        </div>
      </div>

      <!-- Auto-sync indicator (compact: dot + text or countdown) -->
      <div id="auto-sync-status" class="auto-sync-status">
        <span id="auto-sync-dot" class="dot dot-active"></span>
        <span id="auto-sync-text" data-i18n="popup_autoSyncActive">Auto-sync active</span>
        <span id="next-sync-countdown" class="next-sync-countdown" style="display: none;"></span>
      </div>
    </div>

    <footer class="popup-footer">
      <a id="settings-link" href="#" data-i18n="popup_settings">Settings</a>
      <span class="footer-sep">·</span>
      <a href="https://github.com/d0dg3r/GitSyncMarks" target="_blank" rel="noopener">GitHub</a>
      <span class="footer-sep">·</span>
      <a href="https://github.com/d0dg3r/GitSyncMarks/issues" target="_blank" rel="noopener" data-i18n="popup_reportIssue">Report Issue</a>
    </footer>
  </div>

  <script src="popup.js" type="module"></script>
</body>
</html>
